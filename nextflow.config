process {
    withName:tile_adapter {
        container = 'brianyee/python3-essentials:1.1.1'
        containerOptions = '--bind /projects --bind /oasis'
    }
    withName:trim_adapter {
        container = 'brianyee/cutadapt:2.8'
        containerOptions = '--bind /projects --bind /oasis'
    }
    withName:extract_umi_and_trim_polyG {
        container = 'brianyee/fastp:0.23.3'
        containerOptions = '--bind /projects --bind /oasis'
    }
    withName:trim_umi_from_read2 {
        container = 'brianyee/seqtk:1.4'
        containerOptions = '--bind /projects --bind /oasis'
    }
    withName:demultiplex {
        container = 'brianyee/ultraplex:1.2.5'
        containerOptions = '--bind /projects --bind /oasis'
    }
    withName:trim_barcode_r1 {
        container = 'brianyee/fastp:0.23.3'
        containerOptions = '--bind /projects --bind /oasis'
    }
    withName:fastqc_post_trim {
        container = 'brianyee/fastqc:0.11.8'
        containerOptions = '--bind /projects --bind /oasis'
    }
}

profiles {
    debug { process.beforeScript = 'echo $HOSTNAME' }
    conda {
        conda.enabled          = true
        docker.enabled         = false
        singularity.enabled    = false
        podman.enabled         = false
        shifter.enabled        = false
        charliecloud.enabled   = false
    }
    mamba {
        conda.enabled          = true
        conda.useMamba         = true
        docker.enabled         = false
        singularity.enabled    = false
        podman.enabled         = false
        shifter.enabled        = false
        charliecloud.enabled   = false
    }
    docker {
        docker.enabled         = true
        docker.userEmulation   = true
        singularity.enabled    = false
        podman.enabled         = false
        shifter.enabled        = false
        charliecloud.enabled   = false
    }
    arm {
        docker.runOptions = '-u $(id -u):$(id -g) --platform=linux/amd64'
    }
    singularity {
        singularity.enabled    = true
        singularity.autoMounts = true
        docker.enabled         = false
        podman.enabled         = false
        shifter.enabled        = false
        charliecloud.enabled   = false
    }
    podman {
        podman.enabled         = true
        docker.enabled         = false
        singularity.enabled    = false
        shifter.enabled        = false
        charliecloud.enabled   = false
    }
    shifter {
        shifter.enabled        = true
        docker.enabled         = false
        singularity.enabled    = false
        podman.enabled         = false
        charliecloud.enabled   = false
    }
    charliecloud {
        charliecloud.enabled   = true
        docker.enabled         = false
        singularity.enabled    = false
        podman.enabled         = false
        shifter.enabled        = false
    }
    gitpod {
        executor.name          = 'local'
        executor.cpus          = 16
        executor.memory        = 60.GB
    }
    test          { includeConfig 'conf/test.config'      }
}